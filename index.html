<!DOCTYPE html>
<html>
<head>
    <title>Underground Boxing - Prototype</title>
    <style>
        body { margin: 0; overflow: hidden; background: #222; font-family: sans-serif; }
        canvas { display: block; background: #333; }
        #ui { position: absolute; top: 10px; left: 10px; color: white; pointer-events: none; }
    </style>
</head>
<body>
    <div id="ui">
        <h1>Underground: Territory War</h1>
        <p>Use WASD or Arrow Keys to move.</p>
    </div>
    <canvas id="gameCanvas"></canvas>

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// --- Game State & Data ---
const player = {
    x: 100, y: 100, size: 30, speed: 5, color: '#00AAFF',
    isAttacking: false, attackTimer: 0, direction: 'right'
};

const myClique = [
    { x: 80, y: 80, size: 25, color: '#55CCFF', offsetX: -40, offsetY: -40 }
];

const territories = [
    { name: "The Docks (Enemy)", x: 0, y: 0, w: 400, h: 400, color: 'rgba(255, 0, 0, 0.2)' },
    { name: "Neutral Grounds", x: 400, y: 0, w: 600, h: 800, color: 'rgba(100, 100, 100, 0.2)' },
    { name: "Your Turf", x: 0, y: 400, w: 400, h: 400, color: 'rgba(0, 255, 0, 0.2)' }
];

let currentZone = "Unknown";

// --- Input Handling ---
const keys = {};
window.addEventListener('keydown', e => {
    keys[e.key.toLowerCase()] = true;
    if (e.code === 'Space' && !player.isAttacking) {
        player.isAttacking = true;
        player.attackTimer = 10; // Punch lasts 10 frames
    }
});
window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

function update() {
    // Player Movement & Direction
    if (keys['w']) { player.y -= player.speed; player.direction = 'up'; }
    if (keys['s']) { player.y += player.speed; player.direction = 'down'; }
    if (keys['a']) { player.x -= player.speed; player.direction = 'left'; }
    if (keys['d']) { player.x += player.speed; player.direction = 'right'; }

    // Update Clique (Followers lag behind slightly for a natural feel)
    myClique.forEach(member => {
        member.x += (player.x + member.offsetX - member.x) * 0.1;
        member.y += (player.y + member.offsetY - member.y) * 0.1;
    });

    // Territory Detection
    currentZone = "No Man's Land";
    territories.forEach(zone => {
        if (player.x > zone.x && player.x < zone.x + zone.w &&
            player.y > zone.y && player.y < zone.y + zone.h) {
            currentZone = zone.name;
        }
    });

    // Combat Logic
    if (player.isAttacking) {
        player.attackTimer--;
        if (player.attackTimer <= 0) player.isAttacking = false;
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 1. Draw Territories
    territories.forEach(zone => {
        ctx.fillStyle = zone.color;
        ctx.fillRect(zone.x, zone.y, zone.w, zone.h);
        ctx.fillStyle = "white";
        ctx.fillText(zone.name, zone.x + 10, zone.y + 20);
    });

    // 2. Draw Clique
    myClique.forEach(member => {
        ctx.fillStyle = member.color;
        ctx.fillRect(member.x, member.y, member.size, member.size);
    });

    // 3. Draw Player
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.size, player.size);

    // 4. Draw Combat (The Punch)
    if (player.isAttacking) {
        ctx.fillStyle = "yellow";
        let punchX = player.x;
        let punchY = player.y;
        if (player.direction === 'right') punchX += player.size;
        if (player.direction === 'left') punchX -= 15;
        if (player.direction === 'up') punchY -= 15;
        if (player.direction === 'down') punchY += player.size;
        ctx.fillRect(punchX, punchY, 15, 15);
    }

    // 5. Update UI
    ctx.fillStyle = "white";
    ctx.font = "20px Arial";
    ctx.fillText("Location: " + currentZone, 20, canvas.height - 30);
    ctx.fillText("Action: SPACE to Punch", 20, canvas.height - 60);

    requestAnimationFrame(drawLoop);
}

function drawLoop() {
    update();
    draw();
}
drawLoop();
</script>
</body>
</html>
